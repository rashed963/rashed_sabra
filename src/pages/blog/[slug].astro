---
import { getCollection, getEntry, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const entries = await getCollection("blog", ({ data }) => !data.draft);
  return entries.map((entry) => ({
    params: { slug: entry.id },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content, headings } = await render(entry);
const { title, description, publishDate, series, part, heroImage } = entry.data;
---

<Layout>
  <main
    style="max-width: 52rem; margin: 0 auto; padding: 1.5rem; font-family: system-ui, sans-serif; line-height: 1.6;"
  >
    <article>
      <header style="margin-bottom: 1.5rem;">
        {series && (
          <p style="font-size: 0.875rem; color: #666; margin: 0 0 0.25rem;">
            {series}
            {part != null ? ` Â· Part ${part}` : ""}
          </p>
        )}
        <h1 style="font-size: 1.75rem; font-weight: 700; margin: 0 0 0.5rem;">
          {title}
        </h1>
        <time
          datetime={publishDate.toISOString()}
          style="font-size: 0.875rem; color: #666;"
        >
          {publishDate.toLocaleDateString("en-CA", {
            year: "numeric",
            month: "long",
            day: "numeric",
          })}
        </time>
        {description && (
          <p style="margin: 0.75rem 0 0; color: #444; font-size: 1rem;">
            {description}
          </p>
        )}
      </header>
      <div class="prose">
        <Content />
      </div>
    </article>
  </main>
</Layout>

<style>
  .prose :global(p) {
    margin: 0 0 1rem;
  }
  .prose :global(strong) {
    font-weight: 600;
  }
</style>
