---
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const entries = await getCollection("blog", ({ data }) => !data.draft);
  return entries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);
const { title, description, publishDate, series, part } = entry.data;
---

<Layout>
  <main class="container">
    <article class="card">
      <header class="post-header">
        {series && (
          <p class="meta">
            {series}
            {part != null ? ` · الجزء ${part}` : ""}
          </p>
        )}
        <h1 class="hero-title">{title}</h1>
        <time datetime={publishDate.toISOString()} class="meta">
          {publishDate.toLocaleDateString("ar-EG", {
            year: "numeric",
            month: "long",
            day: "numeric",
          })}
        </time>
        {description && (
          <p class="post-description">{description}</p>
        )}
      </header>
      <div class="prose">
        <Content />
      </div>
    </article>
  </main>
</Layout>
