---
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const entries = await getCollection("blog", ({ data }) => !data.draft);
  return entries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);
const { title, description, publishDate, series, part } = entry.data;
---

<Layout>
  <main class="container">
    <article class="card">
      <header style="margin-bottom: 1.75rem;">
        {series && (
          <p class="muted" style="margin: 0 0 0.5rem; font-size: 0.95rem;">
            {series}
            {part != null ? ` · الجزء ${part}` : ""}
          </p>
        )}
        <h1 style="margin: 0 0 0.75rem; font-size: 2rem;">{title}</h1>
        <time
          datetime={publishDate.toISOString()}
          class="muted"
          style="font-size: 0.9rem;"
        >
          {publishDate.toLocaleDateString("ar-EG", {
            year: "numeric",
            month: "long",
            day: "numeric",
          })}
        </time>
        {description && (
          <p style="margin: 0.9rem 0 0; color: #444; font-size: 1.05rem;">
            {description}
          </p>
        )}
      </header>
      <div class="prose">
        <Content />
      </div>
    </article>
  </main>
</Layout>

<style>
  .prose :global(p) {
    margin: 0 0 1.1rem;
  }

  .prose :global(h2) {
    margin: 2rem 0 0.75rem;
    font-size: 1.5rem;
  }

  .prose :global(h3) {
    margin: 1.5rem 0 0.5rem;
    font-size: 1.25rem;
  }

  .prose :global(ul),
  .prose :global(ol) {
    margin: 0 1.25rem 1rem 0;
  }

  .prose :global(li) {
    margin-bottom: 0.5rem;
  }

  .prose :global(strong) {
    font-weight: 600;
  }
</style>
