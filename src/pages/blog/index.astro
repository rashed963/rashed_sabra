---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";

const entries = await getCollection("blog", ({ data }) => !data.draft);
const posts = entries.sort(
  (a, b) => new Date(b.data.publishDate).valueOf() - new Date(a.data.publishDate).valueOf()
);
---

<Layout>
  <main style="max-width: 52rem; margin: 0 auto; padding: 1.5rem; font-family: system-ui, sans-serif;">
    <h1 style="font-size: 1.75rem; font-weight: 700;">Blog</h1>
    <ul style="list-style: none; padding: 0; margin: 1.5rem 0 0;">
      {
        posts.map((entry) => (
          <li style="margin-bottom: 1.25rem;">
            <a
              href={`/blog/${entry.id}`}
              style="color: inherit; text-decoration: none; font-weight: 500; display: block;"
            >
              {entry.data.title}
            </a>
            <time
              datetime={entry.data.publishDate.toISOString()}
              style="font-size: 0.875rem; color: #666;"
            >
              {entry.data.publishDate.toLocaleDateString("en-CA", {
                year: "numeric",
                month: "short",
                day: "numeric",
              })}
            </time>
            {entry.data.series && (
              <span style="font-size: 0.875rem; color: #666; margin-left: 0.5rem;">
                Â· {entry.data.series}
                {entry.data.part != null ? `, part ${entry.data.part}` : ""}
              </span>
            )}
          </li>
        ))
      }
    </ul>
  </main>
</Layout>
