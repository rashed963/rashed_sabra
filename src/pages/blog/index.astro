---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";

const entries = await getCollection("blog", ({ data }) => !data.draft);
const posts = entries.sort(
  (a, b) =>
    new Date(b.data.publishDate).valueOf() -
    new Date(a.data.publishDate).valueOf()
);
---

<Layout>
  <main class="container">
    <section>
      <h1 class="page-title">المدونة</h1>
      <ul class="card-list">
        {posts.map((entry) => (
          <li>
            <a href={`/blog/${entry.slug}`} class="card card-link">
              <h2 class="card-title">{entry.data.title}</h2>
              <p class="muted card-description">{entry.data.description}</p>
              <div class="card-meta">
                <time datetime={entry.data.publishDate.toISOString()} class="meta">
                  {entry.data.publishDate.toLocaleDateString("ar-EG", {
                    year: "numeric",
                    month: "long",
                    day: "numeric",
                  })}
                </time>
                {entry.data.series && (
                  <span class="meta">
                    · {entry.data.series}
                    {entry.data.part != null ? `، الجزء ${entry.data.part}` : ""}
                  </span>
                )}
              </div>
            </a>
          </li>
        ))}
      </ul>
    </section>
  </main>
</Layout>
